/*
    Functions are:

    Z15Equations(r)
        The equations for Z(15, r). This function polynomials whose vanishing cuts out 
        the surface Z(15,r).

    W15Moduli(r)
        Returns a pair j*j', (j - 1728)*(j' - 1728) giving the moduli 
        interpretation of W(15, r) = Z(15, r)/i which is indentified with the (u,v) plane.               
        
*/

function Z15Equations(r)
    // The equations for Z(15, r). This function polynomials whose vanishing cuts out 
    // the surface Z(15,r).      
    assert GCD(r, 15) eq 1;
    
    if not IsSquare(GF(5)!r) and not IsSquare(GF(3)!r) then //Z(15,2)
        PP<u,v,z> := PolynomialRing(Rationals(), 3);
        f := -(7*u^8*v^6 - 26*u^8*v^5 + 41*u^8*v^4 - 44*u^8*v^3 + 41*u^8*v^2 - 26*u^8*v + 
            7*u^8 - 10*u^7*v^7 - 6*u^7*v^6 + 70*u^7*v^5 - 94*u^7*v^4 + 82*u^7*v^3 - 
            82*u^7*v^2 + 50*u^7*v - 10*u^7 + 11*u^6*v^8 + 2*u^6*v^7 + 58*u^6*v^6 - 
            204*u^6*v^5 + 210*u^6*v^4 - 162*u^6*v^3 + 142*u^6*v^2 - 68*u^6*v + 11*u^6 - 
            2*u^5*v^9 - 36*u^5*v^8 + 42*u^5*v^7 - 152*u^5*v^6 + 290*u^5*v^5 - 200*u^5*v^4 + 
            120*u^5*v^3 - 90*u^5*v^2 + 30*u^5*v - 2*u^5 - 2*u^4*v^10 + 12*u^4*v^9 + 
            47*u^4*v^8 - 76*u^4*v^7 + 188*u^4*v^6 - 232*u^4*v^5 + 103*u^4*v^4 - 46*u^4*v^3 +
            22*u^4*v^2 + 2*u^4*v - 2*u^4 + 8*u^3*v^11 - 30*u^3*v^10 + 60*u^3*v^9 - 
            154*u^3*v^8 + 174*u^3*v^7 - 168*u^3*v^6 + 50*u^3*v^5 + 88*u^3*v^4 - 106*u^3*v^3 
            + 80*u^3*v^2 - 38*u^3*v + 8*u^3 - u^2*v^12 - 20*u^2*v^11 + 80*u^2*v^10 - 
            168*u^2*v^9 + 270*u^2*v^8 - 270*u^2*v^7 + 220*u^2*v^6 - 120*u^2*v^5 + 57*u^2*v^4
            - 26*u^2*v^3 + 2*u^2*v^2 + 4*u^2*v - u^2 + 24*u*v^11 - 80*u*v^10 + 150*u*v^9 - 
            182*u*v^8 + 134*u*v^7 - 56*u*v^6 - 6*u*v^5 + 18*u*v^4 - 12*u*v^3 + 6*u*v^2 - 
            2*u*v - 16*v^10 + 64*v^9 - 136*v^8 + 184*v^7 - 169*v^6 + 106*v^5 - 43*v^4 + 
            10*v^3 - v^2);

        return [z^2 - f];

    elif IsSquare(GF(5)!r) and not IsSquare(GF(3)!r) then //Z(15,14)
        PP<u,v,z> := PolynomialRing(Rationals(), 3);
        f := u^10*v^8 + 2*u^10*v^7 + u^10*v^6 + 4*u^9*v^9 + 22*u^9*v^8 + 20*u^9*v^7 + 
            8*u^9*v^6 + 6*u^9*v^5 + 6*u^8*v^10 + 68*u^8*v^9 + 101*u^8*v^8 + 114*u^8*v^7 + 
            47*u^8*v^6 + 14*u^8*v^5 + 15*u^8*v^4 + 4*u^7*v^11 + 92*u^7*v^10 + 212*u^7*v^9 + 
            370*u^7*v^8 + 268*u^7*v^7 + 142*u^7*v^6 + 12*u^7*v^5 + 20*u^7*v^4 + 20*u^7*v^3 +
            u^6*v^12 + 58*u^6*v^11 + 215*u^6*v^10 + 520*u^6*v^9 + 595*u^6*v^8 + 446*u^6*v^7 
            + 63*u^6*v^6 - 54*u^6*v^5 - 51*u^6*v^4 + 30*u^6*v^3 + 15*u^6*v^2 + 14*u^5*v^12 +
            104*u^5*v^11 + 360*u^5*v^10 + 598*u^5*v^9 + 610*u^5*v^8 + 162*u^5*v^7 - 
            260*u^5*v^6 - 374*u^5*v^5 - 180*u^5*v^4 - 28*u^5*v^3 + 32*u^5*v^2 + 6*u^5*v + 
            19*u^4*v^12 + 118*u^4*v^11 + 285*u^4*v^10 + 390*u^4*v^9 + 133*u^4*v^8 - 
            358*u^4*v^7 - 734*u^4*v^6 - 644*u^4*v^5 - 276*u^4*v^4 - 40*u^4*v^3 + 29*u^4*v^2 
            + 18*u^4*v + u^4 + 14*u^3*v^12 + 56*u^3*v^11 + 108*u^3*v^10 + 34*u^3*v^9 - 
            238*u^3*v^8 - 606*u^3*v^7 - 720*u^3*v^6 - 482*u^3*v^5 - 118*u^3*v^4 + 88*u^3*v^3
            + 68*u^3*v^2 + 28*u^3*v + 4*u^3 + u^2*v^12 + 10*u^2*v^11 - 3*u^2*v^10 - 
            68*u^2*v^9 - 203*u^2*v^8 - 318*u^2*v^7 - 263*u^2*v^6 - 50*u^2*v^5 + 153*u^2*v^4 
            + 208*u^2*v^3 + 127*u^2*v^2 + 36*u^2*v + 6*u^2 - 2*u*v^10 - 20*u*v^9 - 36*u*v^8 
            - 30*u*v^7 + 24*u*v^6 + 124*u*v^5 + 178*u*v^4 + 160*u*v^3 + 96*u*v^2 + 30*u*v + 
            4*u + v^8 + 10*v^7 + 25*v^6 + 42*v^5 + 52*v^4 + 42*v^3 + 25*v^2 + 10*v + 1;

        return [z^2 - f];
    end if;
end function;


function W15Moduli(r)
    // Returns a pair j*j', (j - 1728)*(j' - 1728) giving the moduli 
    // interpretation of W(15, r) = Z(15, r)/i which is indentified with the (u,v) plane.        
    assert GCD(r, 15) eq 1;

    if not IsSquare(GF(5)!r) and not IsSquare(GF(3)!r) then //Z(15,2)
        P<u,v> := FunctionField(Rationals(), 2);
        jj := (225*u^12*v^12 - 1620*u^12*v^11 + 5778*u^12*v^10 - 14580*u^12*v^9 + 
            29295*u^12*v^8 - 46008*u^12*v^7 + 53820*u^12*v^6 - 46008*u^12*v^5 + 
            29295*u^12*v^4 - 14580*u^12*v^3 + 5778*u^12*v^2 - 1620*u^12*v + 225*u^12 - 
            1080*u^11*v^13 + 6804*u^11*v^12 - 21600*u^11*v^11 + 44820*u^11*v^10 - 
            54648*u^11*v^9 + 6264*u^11*v^8 + 108216*u^11*v^7 - 214704*u^11*v^6 + 
            235440*u^11*v^5 - 177012*u^11*v^4 + 97416*u^11*v^3 - 38340*u^11*v^2 + 
            9504*u^11*v - 1080*u^11 + 2268*u^10*v^14 - 8820*u^10*v^13 + 5778*u^10*v^12 + 
            53244*u^10*v^11 - 225288*u^10*v^10 + 459108*u^10*v^9 - 535248*u^10*v^8 + 
            311400*u^10*v^7 + 50436*u^10*v^6 - 284580*u^10*v^5 + 305154*u^10*v^4 - 
            198612*u^10*v^3 + 83592*u^10*v^2 - 20700*u^10*v + 2268*u^10 - 2280*u^9*v^15 - 
            252*u^9*v^14 + 34524*u^9*v^13 - 106104*u^9*v^12 + 105696*u^9*v^11 + 
            189540*u^9*v^10 - 785064*u^9*v^9 + 1236960*u^9*v^8 - 1133820*u^9*v^7 + 
            600756*u^9*v^6 - 65520*u^9*v^5 - 195264*u^9*v^4 + 191076*u^9*v^3 - 90396*u^9*v^2
            + 22428*u^9*v - 2280*u^9 + 1894*u^8*v^16 + 716*u^8*v^15 + 6666*u^8*v^14 - 
            116436*u^8*v^13 + 458541*u^8*v^12 - 973668*u^8*v^11 + 1250738*u^8*v^10 - 
            975248*u^8*v^9 + 411795*u^8*v^8 - 40508*u^8*v^7 + 21104*u^8*v^6 - 177492*u^8*v^5
            + 263358*u^8*v^4 - 199488*u^8*v^3 + 85938*u^8*v^2 - 19804*u^8*v + 1894*u^8 - 
            968*u^7*v^17 - 2212*u^7*v^16 - 8392*u^7*v^15 + 41592*u^7*v^14 + 10632*u^7*v^13 -
            413928*u^7*v^12 + 1327472*u^7*v^11 - 2403932*u^7*v^10 + 3035656*u^7*v^9 - 
            2928824*u^7*v^8 + 2261228*u^7*v^7 - 1465552*u^7*v^6 + 856608*u^7*v^5 - 
            466488*u^7*v^4 + 214728*u^7*v^3 - 69592*u^7*v^2 + 12940*u^7*v - 968*u^7 + 
            732*u^6*v^18 - 2220*u^6*v^17 + 21758*u^6*v^16 - 42636*u^6*v^15 + 16674*u^6*v^14 
            + 42948*u^6*v^13 + 93264*u^6*v^12 - 746004*u^6*v^11 + 1855198*u^6*v^10 - 
            2888616*u^6*v^9 + 3241254*u^6*v^8 - 2768248*u^6*v^7 + 1873392*u^6*v^6 - 
            1045776*u^6*v^5 + 493206*u^6*v^4 - 189048*u^6*v^3 + 52530*u^6*v^2 - 8996*u^6*v +
            732*u^6 + 232*u^5*v^19 - 5236*u^5*v^18 + 27756*u^5*v^17 - 120504*u^5*v^16 + 
            311100*u^5*v^15 - 549924*u^5*v^14 + 701320*u^5*v^13 - 732100*u^5*v^12 + 
            793056*u^5*v^11 - 992652*u^5*v^10 + 1217328*u^5*v^9 - 1216512*u^5*v^8 + 
            926616*u^5*v^7 - 534168*u^5*v^6 + 236856*u^5*v^5 - 82208*u^5*v^4 + 20072*u^5*v^3
            - 1500*u^5*v^2 - 844*u^5*v + 232*u^5 + u^4*v^20 - 472*u^4*v^19 + 8084*u^4*v^18 -
            39624*u^4*v^17 + 145866*u^4*v^16 - 350172*u^4*v^15 + 594256*u^4*v^14 - 
            695188*u^4*v^13 + 510023*u^4*v^12 - 81480*u^4*v^11 - 385986*u^4*v^10 + 
            690336*u^4*v^9 - 766476*u^4*v^8 + 653676*u^4*v^7 - 444516*u^4*v^6 + 
            237688*u^4*v^5 - 96664*u^4*v^4 + 28916*u^4*v^3 - 5956*u^4*v^2 + 688*u^4*v + u^4 
            + 224*u^3*v^19 - 3708*u^3*v^18 + 14244*u^3*v^17 - 44496*u^3*v^16 + 
            88092*u^3*v^15 - 113196*u^3*v^14 + 47204*u^3*v^13 + 147024*u^3*v^12 - 
            425400*u^3*v^11 + 663588*u^3*v^10 - 747612*u^3*v^9 + 654720*u^3*v^8 - 
            453912*u^3*v^7 + 248040*u^3*v^6 - 103872*u^3*v^5 + 31640*u^3*v^4 - 6336*u^3*v^3 
            + 660*u^3*v^2 + 4*u^3*v + 240*u^2*v^18 + 816*u^2*v^17 - 3946*u^2*v^16 + 
            13108*u^2*v^15 - 29562*u^2*v^14 + 58172*u^2*v^13 - 95612*u^2*v^12 + 
            132648*u^2*v^11 - 150774*u^2*v^10 + 139296*u^2*v^9 - 102990*u^2*v^8 + 
            59924*u^2*v^7 - 26642*u^2*v^6 + 8580*u^2*v^5 - 1774*u^2*v^4 + 172*u^2*v^3 + 
            6*u^2*v^2 - 256*u*v^17 + 760*u*v^16 - 1376*u*v^15 + 1028*u*v^14 + 652*u*v^13 - 
            3548*u*v^12 + 6096*u*v^11 - 7176*u*v^10 + 6324*u*v^9 - 4336*u*v^8 + 2284*u*v^7 -
            896*u*v^6 + 248*u*v^5 - 44*u*v^4 + 4*u*v^3 + 16*v^16 - 96*v^15 + 312*v^14 - 
            680*v^13 + 1089*v^12 - 1332*v^11 + 1266*v^10 - 936*v^9 + 531*v^8 - 224*v^7 + 
            66*v^6 - 12*v^5 + v^4)^(3)/((v^2 - v + 1)^(9)*(u)^(3)*(u*v - u 
            - v)^(3)*(u^2*v - u^2 - u*v - v^2 + v)^(15));
        
        jj_1728 := (5103*u^18*v^18 - 59778*u^18*v^17 + 320031*u^18*v^16 - 1020600*u^18*v^15 + 
            2102436*u^18*v^14 - 2758536*u^18*v^13 + 1799172*u^18*v^12 + 1020600*u^18*v^11 - 
            4226742*u^18*v^10 + 5636628*u^18*v^9 - 4226742*u^18*v^8 + 1020600*u^18*v^7 + 
            1799172*u^18*v^6 - 2758536*u^18*v^5 + 2102436*u^18*v^4 - 1020600*u^18*v^3 + 
            320031*u^18*v^2 - 59778*u^18*v + 5103*u^18 - 24300*u^17*v^19 + 186138*u^17*v^18 
            - 437400*u^17*v^17 - 629856*u^17*v^16 + 6639732*u^17*v^15 - 20067912*u^17*v^14 +
            35441064*u^17*v^13 - 39211452*u^17*v^12 + 21686292*u^17*v^11 + 
            11048724*u^17*v^10 - 39680928*u^17*v^9 + 47037996*u^17*v^8 - 32230548*u^17*v^7 +
            10036872*u^17*v^6 + 4181544*u^17*v^5 - 6954660*u^17*v^4 + 4146552*u^17*v^3 - 
            1421550*u^17*v^2 + 277992*u^17*v - 24300*u^17 + 67230*u^16*v^20 - 
            413910*u^16*v^19 + 1038501*u^16*v^18 - 2738286*u^16*v^17 + 15073371*u^16*v^16 - 
            66467466*u^16*v^15 + 190635039*u^16*v^14 - 381801276*u^16*v^13 + 
            568121445*u^16*v^12 - 651161430*u^16*v^11 + 582897789*u^16*v^10 - 
            407787696*u^16*v^9 + 227338731*u^16*v^8 - 115326990*u^16*v^7 + 70546869*u^16*v^6
            - 51521508*u^16*v^5 + 32696217*u^16*v^4 - 15007356*u^16*v^3 + 4570506*u^16*v^2 -
            827010*u^16*v + 67230*u^16 - 132300*u^15*v^21 + 726678*u^15*v^20 - 
            2389554*u^15*v^19 + 9508428*u^15*v^18 - 32749542*u^15*v^17 + 62653068*u^15*v^16 
            - 13377582*u^15*v^15 - 273374298*u^15*v^14 + 892316952*u^15*v^13 - 
            1714973256*u^15*v^12 + 2396896974*u^15*v^11 - 2597922018*u^15*v^10 + 
            2248399512*u^15*v^9 - 1596031560*u^15*v^8 + 969029622*u^15*v^7 - 
            530874270*u^15*v^6 + 268968492*u^15*v^5 - 120550950*u^15*v^4 + 43446780*u^15*v^3
            - 11241234*u^15*v^2 + 1802358*u^15*v - 132300*u^15 + 210033*u^14*v^22 - 
            1113264*u^14*v^21 + 4167288*u^14*v^20 - 13418784*u^14*v^19 + 20701575*u^14*v^18 
            + 30851928*u^14*v^17 - 221611707*u^14*v^16 + 494844228*u^14*v^15 - 
            521069598*u^14*v^14 - 141498738*u^14*v^13 + 1612660023*u^14*v^12 - 
            3383816148*u^14*v^11 + 4568263353*u^14*v^10 - 4606151508*u^14*v^9 + 
            3688232292*u^14*v^8 - 2446659432*u^14*v^7 + 1387146303*u^14*v^6 - 
            678098142*u^14*v^5 + 278501895*u^14*v^4 - 90404424*u^14*v^3 + 21150558*u^14*v^2 
            - 3097764*u^14*v + 210033*u^14 - 218520*u^13*v^23 + 553572*u^13*v^22 + 
            1020888*u^13*v^21 - 16786926*u^13*v^20 + 91747458*u^13*v^19 - 
            284626278*u^13*v^18 + 532265814*u^13*v^17 - 537891336*u^13*v^16 - 
            17166420*u^13*v^15 + 987230394*u^13*v^14 - 1570394232*u^13*v^13 + 
            889391952*u^13*v^12 + 1049469660*u^13*v^11 - 3159990072*u^13*v^10 + 
            4246585668*u^13*v^9 - 4000679352*u^13*v^8 + 2954234448*u^13*v^7 - 
            1790937306*u^13*v^6 + 900425268*u^13*v^5 - 367071210*u^13*v^4 + 
            115076862*u^13*v^3 - 25515846*u^13*v^2 + 3494034*u^13*v - 218520*u^13 + 
            151460*u^12*v^24 + 280932*u^12*v^23 - 4037694*u^12*v^22 + 16908944*u^12*v^21 - 
            29079978*u^12*v^20 - 64596342*u^12*v^19 + 504410234*u^12*v^18 - 
            1425363516*u^12*v^17 + 2423826486*u^12*v^16 - 2552127656*u^12*v^15 + 
            1143380739*u^12*v^14 + 1230499662*u^12*v^13 - 2966143832*u^12*v^12 + 
            2903074098*u^12*v^11 - 1380032790*u^12*v^10 - 344278688*u^12*v^9 + 
            1336825233*u^12*v^8 - 1472854986*u^12*v^7 + 1107578462*u^12*v^6 - 
            633374994*u^12*v^5 + 276672963*u^12*v^4 - 88741354*u^12*v^3 + 19430985*u^12*v^2 
            - 2559828*u^12*v + 151460*u^12 - 54456*u^11*v^25 - 765108*u^11*v^24 + 
            3440292*u^11*v^23 - 4672368*u^11*v^22 - 21471960*u^11*v^21 + 125040846*u^11*v^20
            - 250644054*u^11*v^19 + 52776372*u^11*v^18 + 941465574*u^11*v^17 - 
            2665719840*u^11*v^16 + 4053162006*u^11*v^15 - 3710095602*u^11*v^14 + 
            1351788624*u^11*v^13 + 1685516394*u^11*v^12 - 3640004112*u^11*v^11 + 
            3805437810*u^11*v^10 - 2722031958*u^11*v^9 + 1354937904*u^11*v^8 - 
            362787108*u^11*v^7 - 92169612*u^11*v^6 + 170099448*u^11*v^5 - 103437000*u^11*v^4
            + 37605516*u^11*v^3 - 8415564*u^11*v^2 + 1052412*u^11*v - 54456*u^11 + 
            15105*u^10*v^26 + 320526*u^10*v^25 + 1089999*u^10*v^24 - 11805540*u^10*v^23 + 
            42842118*u^10*v^22 - 59814390*u^10*v^21 - 103782813*u^10*v^20 + 
            679339644*u^10*v^19 - 1651752483*u^10*v^18 + 2553054576*u^10*v^17 - 
            2835191367*u^10*v^16 + 2559081204*u^10*v^15 - 2460063234*u^10*v^14 + 
            3122803176*u^10*v^13 - 4264842606*u^10*v^12 + 5034587820*u^10*v^11 - 
            4842288888*u^10*v^10 + 3767189784*u^10*v^9 - 2349006711*u^10*v^8 + 
            1139515668*u^10*v^7 - 399399255*u^10*v^6 + 81307074*u^10*v^5 + 1932843*u^10*v^4 
            - 6940020*u^10*v^3 + 2071155*u^10*v^2 - 278490*u^10*v + 15105*u^10 + 
            3076*u^9*v^27 - 153438*u^9*v^26 - 426144*u^9*v^25 - 391868*u^9*v^24 + 
            16145952*u^9*v^23 - 80890782*u^9*v^22 + 182078004*u^9*v^21 - 75258582*u^9*v^20 -
            805785402*u^9*v^19 + 3038461686*u^9*v^18 - 6581456418*u^9*v^17 + 
            10478242704*u^9*v^16 - 13349433868*u^9*v^15 + 14271704868*u^9*v^14 - 
            13238970996*u^9*v^13 + 10928945034*u^9*v^12 - 8177035998*u^9*v^11 + 
            5590345134*u^9*v^10 - 3463854174*u^9*v^9 + 1893462960*u^9*v^8 - 
            873423156*u^9*v^7 + 319365946*u^9*v^6 - 84667476*u^9*v^5 + 13942632*u^9*v^4 - 
            885468*u^9*v^3 - 64914*u^9*v^2 - 2388*u^9*v + 3076*u^9 + 11550*u^8*v^28 - 
            198702*u^8*v^27 + 2019081*u^8*v^26 - 8502114*u^8*v^25 + 31873575*u^8*v^24 - 
            108729336*u^8*v^23 + 325495290*u^8*v^22 - 766664958*u^8*v^21 + 
            1308234378*u^8*v^20 - 1408115298*u^8*v^19 + 263704062*u^8*v^18 + 
            2514158988*u^8*v^17 - 6259982676*u^8*v^16 + 9404532906*u^8*v^15 - 
            10486556862*u^8*v^14 + 9166194096*u^8*v^13 - 6345315033*u^8*v^12 + 
            3399523134*u^8*v^11 - 1279788693*u^8*v^10 + 183259536*u^8*v^9 + 
            186308094*u^8*v^8 - 210760410*u^8*v^7 + 136724727*u^8*v^6 - 66565434*u^8*v^5 + 
            24868839*u^8*v^4 - 6892788*u^8*v^3 + 1345548*u^8*v^2 - 171018*u^8*v + 11550*u^8 
            + 516*u^7*v^29 - 53442*u^7*v^28 + 762174*u^7*v^27 - 6323532*u^7*v^26 + 
            28739526*u^7*v^25 - 99494898*u^7*v^24 + 283896924*u^7*v^23 - 705085818*u^7*v^22 
            + 1515672402*u^7*v^21 - 2757964578*u^7*v^20 + 4172527518*u^7*v^19 - 
            5199241056*u^7*v^18 + 5343736110*u^7*v^17 - 4639249734*u^7*v^16 + 
            3705061056*u^7*v^15 - 3237472590*u^7*v^14 + 3415595334*u^7*v^13 - 
            3813278856*u^7*v^12 + 3851513124*u^7*v^11 - 3295532940*u^7*v^10 + 
            2350255956*u^7*v^9 - 1394338290*u^7*v^8 + 688048422*u^7*v^7 - 281247828*u^7*v^6 
            + 93867846*u^7*v^5 - 24748026*u^7*v^4 + 4842204*u^7*v^3 - 624306*u^7*v^2 + 
            38958*u^7*v + 516*u^7 - u^6*v^30 - 1020*u^6*v^29 + 79626*u^6*v^28 - 
            1005700*u^6*v^27 + 7494159*u^6*v^26 - 32165850*u^6*v^25 + 101645640*u^6*v^24 - 
            256556460*u^6*v^23 + 558803955*u^6*v^22 - 1088331600*u^6*v^21 + 
            1912170639*u^6*v^20 - 3010556316*u^6*v^19 + 4224410784*u^6*v^18 - 
            5305640160*u^6*v^17 + 6045406581*u^6*v^16 - 6363037368*u^6*v^15 + 
            6269001312*u^6*v^14 - 5783516220*u^6*v^13 + 4928556759*u^6*v^12 - 
            3796365972*u^6*v^11 + 2583897735*u^6*v^10 - 1522189968*u^6*v^9 + 
            761694690*u^6*v^8 - 317652888*u^6*v^7 + 107848746*u^6*v^6 - 28749360*u^6*v^5 + 
            5629737*u^6*v^4 - 699436*u^6*v^3 + 32544*u^6*v^2 + 2592*u^6*v - u^6 + 
            528*u^5*v^29 - 46470*u^5*v^28 + 518226*u^5*v^27 - 3563484*u^5*v^26 + 
            13392006*u^5*v^25 - 34909026*u^5*v^24 + 66526134*u^5*v^23 - 102500502*u^5*v^22 +
            147635538*u^5*v^21 - 240894294*u^5*v^20 + 447046602*u^5*v^19 - 
            805948674*u^5*v^18 + 1272968682*u^5*v^17 - 1713738210*u^5*v^16 + 
            1972971978*u^5*v^15 - 1962641346*u^5*v^14 + 1703546106*u^5*v^13 - 
            1297403304*u^5*v^12 + 866311728*u^5*v^11 - 502840752*u^5*v^10 + 
            249381708*u^5*v^9 - 102905934*u^5*v^8 + 33969678*u^5*v^7 - 8390598*u^5*v^6 + 
            1323510*u^5*v^5 - 50082*u^5*v^4 - 28650*u^5*v^3 + 5238*u^5*v^2 - 6*u^5*v + 
            8472*u^4*v^28 - 68808*u^4*v^27 + 456393*u^4*v^26 - 850998*u^4*v^25 - 
            1455261*u^4*v^24 + 14995734*u^4*v^23 - 51643077*u^4*v^22 + 117299508*u^4*v^21 - 
            198096972*u^4*v^20 + 262239018*u^4*v^19 - 281083776*u^4*v^18 + 
            254972940*u^4*v^17 - 213737388*u^4*v^16 + 189020580*u^4*v^15 - 
            186655758*u^4*v^14 + 187028124*u^4*v^13 - 169242585*u^4*v^12 + 
            130435530*u^4*v^11 - 83935185*u^4*v^10 + 44806236*u^4*v^9 - 19721589*u^4*v^8 + 
            7068948*u^4*v^7 - 2013045*u^4*v^6 + 435408*u^4*v^5 - 65283*u^4*v^4 + 
            5370*u^4*v^3 - 15*u^4*v^2 - 7936*u^3*v^27 + 31548*u^3*v^26 - 327216*u^3*v^25 + 
            1744948*u^3*v^24 - 6341796*u^3*v^23 + 16780140*u^3*v^22 - 35089580*u^3*v^21 + 
            60774930*u^3*v^20 - 91293462*u^3*v^19 + 123429256*u^3*v^18 - 154222806*u^3*v^17 
            + 179150304*u^3*v^16 - 191087014*u^3*v^15 + 183154914*u^3*v^14 - 
            154428732*u^3*v^13 + 112552916*u^3*v^12 - 69884010*u^3*v^11 + 36451098*u^3*v^10 
            - 15712096*u^3*v^9 + 5473542*u^3*v^8 - 1490196*u^3*v^7 + 300262*u^3*v^6 - 
            40482*u^3*v^5 + 2880*u^3*v^4 - 20*u^3*v^3 + 6024*u^2*v^26 - 11472*u^2*v^25 - 
            19572*u^2*v^24 + 221868*u^2*v^23 - 826143*u^2*v^22 + 2208564*u^2*v^21 - 
            4797360*u^2*v^20 + 8947728*u^2*v^19 - 14509242*u^2*v^18 + 20487570*u^2*v^17 - 
            25074498*u^2*v^16 + 26477232*u^2*v^15 - 23998698*u^2*v^14 + 18567186*u^2*v^13 - 
            12170691*u^2*v^12 + 6689952*u^2*v^11 - 3037923*u^2*v^10 + 1114902*u^2*v^9 - 
            319713*u^2*v^8 + 67872*u^2*v^7 - 9690*u^2*v^6 + 756*u^2*v^5 - 15*u^2*v^4 - 
            1920*u*v^25 + 11568*u*v^24 - 39984*u*v^23 + 96516*u*v^22 - 183384*u*v^21 + 
            293526*u*v^20 - 419526*u*v^19 + 552672*u*v^18 - 673974*u*v^17 + 746256*u*v^16 - 
            731532*u*v^15 + 621186*u*v^14 - 449532*u*v^13 + 273564*u*v^12 - 138096*u*v^11 + 
            56862*u*v^10 - 18648*u*v^9 + 4698*u*v^8 - 858*u*v^7 + 102*u*v^6 - 6*u*v^5 - 
            64*v^24 + 576*v^23 - 2736*v^22 + 8832*v^21 - 21420*v^20 + 41076*v^19 - 
            64149*v^18 + 83034*v^17 - 89973*v^16 + 81970*v^15 - 62766*v^14 + 40194*v^13 - 
            21309*v^12 + 9198*v^11 - 3150*v^10 + 822*v^9 - 153*v^8 + 18*v^7 - v^6)^(2)/((v^2
            - v + 1)^(9)*(u)^(3)*(u*v - u - v)^(3)*(u^2*v - u^2 - u*v - v^2 + v)^(15));

    elif IsSquare(GF(5)!r) and not IsSquare(GF(3)!r) then //Z(15,14)
        P<u,v> := FunctionField(Rationals(), 2);
        jj := -1*(u^12*v^12 + 4*u^12*v^11 + 6*u^12*v^10 + 4*u^12*v^9 + u^12*v^8 + 4*u^11*v^13 
            + 28*u^11*v^12 + 68*u^11*v^11 + 84*u^11*v^10 + 64*u^11*v^9 + 32*u^11*v^8 + 
            8*u^11*v^7 + 6*u^10*v^14 + 72*u^10*v^13 + 246*u^10*v^12 + 472*u^10*v^11 + 
            584*u^10*v^10 + 472*u^10*v^9 + 268*u^10*v^8 + 116*u^10*v^7 + 28*u^10*v^6 + 
            4*u^9*v^15 + 88*u^9*v^14 + 656*u^9*v^13 + 1396*u^9*v^12 + 1948*u^9*v^11 + 
            2360*u^9*v^10 + 2052*u^9*v^9 + 1004*u^9*v^8 + 384*u^9*v^7 + 252*u^9*v^6 + 
            56*u^9*v^5 + u^8*v^16 + 52*u^8*v^15 + 1082*u^8*v^14 + 3144*u^8*v^13 + 
            5656*u^8*v^12 + 6044*u^8*v^11 + 5530*u^8*v^10 + 4088*u^8*v^9 + 1816*u^8*v^8 - 
            756*u^8*v^7 - 490*u^8*v^6 + 364*u^8*v^5 + 70*u^8*v^4 + 12*u^7*v^16 + 
            876*u^7*v^15 + 4600*u^7*v^14 + 10496*u^7*v^13 + 13780*u^7*v^12 + 14548*u^7*v^11 
            + 5684*u^7*v^10 - 1244*u^7*v^9 - 5020*u^7*v^8 - 8216*u^7*v^7 - 8368*u^7*v^6 - 
            2548*u^7*v^5 + 364*u^7*v^4 + 56*u^7*v^3 + 266*u^6*v^16 + 3468*u^6*v^15 + 
            10764*u^6*v^14 + 21212*u^6*v^13 + 26428*u^6*v^12 + 10464*u^6*v^11 - 
            12686*u^6*v^10 - 33076*u^6*v^9 - 35144*u^6*v^8 - 31904*u^6*v^7 - 29612*u^6*v^6 -
            18652*u^6*v^5 - 3906*u^6*v^4 + 252*u^6*v^3 + 28*u^6*v^2 + 1008*u^5*v^16 + 
            5988*u^5*v^15 + 17076*u^5*v^14 + 26988*u^5*v^13 + 14472*u^5*v^12 - 
            33660*u^5*v^11 - 91772*u^5*v^10 - 110648*u^5*v^9 - 93400*u^5*v^8 - 67052*u^5*v^7
            - 55852*u^5*v^6 - 45356*u^5*v^5 - 21328*u^5*v^4 - 3032*u^5*v^3 + 116*u^5*v^2 + 
            8*u^5*v + 1491*u^4*v^16 + 6528*u^4*v^15 + 14880*u^4*v^14 + 7008*u^4*v^13 - 
            44967*u^4*v^12 - 136908*u^4*v^11 - 215238*u^4*v^10 - 213528*u^4*v^9 - 
            140852*u^4*v^8 - 73792*u^4*v^7 - 50450*u^4*v^6 - 52036*u^4*v^5 - 39332*u^4*v^4 -
            13696*u^4*v^3 - 1196*u^4*v^2 + 32*u^4*v + u^4 + 1008*u^3*v^16 + 3776*u^3*v^15 + 
            44*u^3*v^14 - 31824*u^3*v^13 - 112512*u^3*v^12 - 213312*u^3*v^11 - 
            260620*u^3*v^10 - 211260*u^3*v^9 - 97296*u^3*v^8 - 5672*u^3*v^7 + 13384*u^3*v^6 
            - 11616*u^3*v^5 - 29464*u^3*v^4 - 20040*u^3*v^3 - 4676*u^3*v^2 - 180*u^3*v + 
            4*u^3 + 266*u^2*v^16 - 700*u^2*v^15 - 11960*u^2*v^14 - 46412*u^2*v^13 - 
            103050*u^2*v^12 - 148680*u^2*v^11 - 132438*u^2*v^10 - 47004*u^2*v^9 + 
            53694*u^2*v^8 + 106716*u^2*v^7 + 92820*u^2*v^6 + 43884*u^2*v^5 + 2680*u^2*v^4 - 
            10760*u^2*v^3 - 5626*u^2*v^2 - 652*u^2*v + 6*u^2 - 228*u*v^16 - 1824*u*v^15 - 
            7768*u*v^14 - 19484*u*v^13 - 28480*u*v^12 - 17316*u*v^11 + 26544*u*v^10 + 
            90780*u*v^9 + 137892*u*v^8 + 140112*u*v^7 + 102804*u*v^6 + 54012*u*v^5 + 
            17892*u*v^4 + 636*u*v^3 - 2420*u*v^2 - 676*u*v + 4*u + v^16 + 12*v^15 + 294*v^14
            + 2064*v^13 + 8177*v^12 + 21528*v^11 + 40950*v^10 + 59436*v^9 + 67236*v^8 + 
            59436*v^7 + 40950*v^6 + 21528*v^5 + 8177*v^4 + 1824*v^3 - 186*v^2 - 228*v + 
            1)^(3)/((v)^(12)*(v + 1)^(6)*(u^2*v + u*v^2 + u*v + u + v)^(15));
        
        jj_1728 := -(u^18*v^18 + 6*u^18*v^17 + 15*u^18*v^16 + 20*u^18*v^15 + 15*u^18*v^14 + 
            6*u^18*v^13 + u^18*v^12 + 6*u^17*v^19 + 54*u^17*v^18 + 192*u^17*v^17 + 
            372*u^17*v^16 + 450*u^17*v^15 + 366*u^17*v^14 + 204*u^17*v^13 + 72*u^17*v^12 + 
            12*u^17*v^11 + 15*u^16*v^20 + 198*u^16*v^19 + 942*u^16*v^18 + 2466*u^16*v^17 + 
            4179*u^16*v^16 + 4944*u^16*v^15 + 4230*u^16*v^14 + 2670*u^16*v^13 + 
            1248*u^16*v^12 + 402*u^16*v^11 + 66*u^16*v^10 + 20*u^15*v^21 + 390*u^15*v^20 + 
            1944*u^15*v^19 + 6808*u^15*v^18 + 16926*u^15*v^17 + 28494*u^15*v^16 + 
            33792*u^15*v^15 + 30450*u^15*v^14 + 22050*u^15*v^13 + 12536*u^15*v^12 + 
            5112*u^15*v^11 + 1386*u^15*v^10 + 220*u^15*v^9 + 15*u^14*v^22 + 450*u^14*v^21 + 
            1260*u^14*v^20 + 3828*u^14*v^19 + 20913*u^14*v^18 + 67182*u^14*v^17 + 
            125475*u^14*v^16 + 161586*u^14*v^15 + 162255*u^14*v^14 + 132642*u^14*v^13 + 
            89343*u^14*v^12 + 47418*u^14*v^11 + 16650*u^14*v^10 + 3300*u^14*v^9 + 
            495*u^14*v^8 + 6*u^13*v^23 + 306*u^13*v^22 - 1440*u^13*v^21 - 20190*u^13*v^20 - 
            45072*u^13*v^19 - 18666*u^13*v^18 + 124506*u^13*v^17 + 384144*u^13*v^16 + 
            596652*u^13*v^15 + 681018*u^13*v^14 + 655140*u^13*v^13 + 503724*u^13*v^12 + 
            311856*u^13*v^11 + 150432*u^13*v^10 + 44070*u^13*v^9 + 5742*u^13*v^8 + 
            792*u^13*v^7 + u^12*v^24 + 114*u^12*v^23 - 2958*u^12*v^22 - 50038*u^12*v^21 - 
            198237*u^12*v^20 - 419304*u^12*v^19 - 448015*u^12*v^18 - 6486*u^12*v^17 + 
            762453*u^12*v^16 + 1700920*u^12*v^15 + 2398152*u^12*v^14 + 2629992*u^12*v^13 + 
            2311547*u^12*v^12 + 1561194*u^12*v^11 + 867633*u^12*v^10 + 377870*u^12*v^9 + 
            90603*u^12*v^8 + 7524*u^12*v^7 + 924*u^12*v^6 + 18*u^11*v^24 - 1848*u^11*v^23 - 
            50724*u^11*v^22 - 318354*u^11*v^21 - 957180*u^11*v^20 - 1740240*u^11*v^19 - 
            1940346*u^11*v^18 - 1151664*u^11*v^17 + 639912*u^11*v^16 + 3203496*u^11*v^15 + 
            6372804*u^11*v^14 + 8400768*u^11*v^13 + 8195124*u^11*v^12 + 6026832*u^11*v^11 + 
            3487620*u^11*v^10 + 1793628*u^11*v^9 + 715932*u^11*v^8 + 139176*u^11*v^7 + 
            7524*u^11*v^6 + 792*u^11*v^5 - 411*u^10*v^24 - 24852*u^10*v^23 - 
            276096*u^10*v^22 - 1137072*u^10*v^21 - 2857179*u^10*v^20 - 4623510*u^10*v^19 - 
            5742561*u^10*v^18 - 5898162*u^10*v^17 - 4132068*u^10*v^16 + 1321512*u^10*v^15 + 
            10346550*u^10*v^14 + 19343604*u^10*v^13 + 21797886*u^10*v^12 + 
            17261232*u^10*v^11 + 10225242*u^10*v^10 + 5269284*u^10*v^9 + 2706576*u^10*v^8 + 
            1002240*u^10*v^7 + 156339*u^10*v^6 + 5742*u^10*v^5 + 495*u^10*v^4 - 
            4842*u^9*v^24 - 128190*u^9*v^23 - 806352*u^9*v^22 - 2724878*u^9*v^21 - 
            5779338*u^9*v^20 - 9795654*u^9*v^19 - 15195222*u^9*v^18 - 22116306*u^9*v^17 - 
            25683126*u^9*v^16 - 17536224*u^9*v^15 + 4138632*u^9*v^14 + 28812216*u^9*v^13 + 
            41745412*u^9*v^12 + 36014040*u^9*v^11 + 21228660*u^9*v^10 + 9764728*u^9*v^9 + 
            5136756*u^9*v^8 + 3000546*u^9*v^7 + 1026518*u^9*v^6 + 126240*u^9*v^5 + 
            3300*u^9*v^4 + 220*u^9*v^3 - 25014*u^8*v^24 - 328908*u^8*v^23 - 1575093*u^8*v^22
            - 4439808*u^8*v^21 - 9566583*u^8*v^20 - 19459506*u^8*v^19 - 38196261*u^8*v^18 - 
            63229812*u^8*v^17 - 79855503*u^8*v^16 - 68022402*u^8*v^15 - 24432372*u^8*v^14 + 
            27895356*u^8*v^13 + 58310946*u^8*v^12 + 54496800*u^8*v^11 + 29688480*u^8*v^10 + 
            8582940*u^8*v^9 + 1971837*u^8*v^8 + 2905146*u^8*v^7 + 2473296*u^8*v^6 + 
            759282*u^8*v^5 + 71430*u^8*v^4 + 1386*u^8*v^3 + 66*u^8*v^2 - 59814*u^7*v^24 - 
            522960*u^7*v^23 - 2076600*u^7*v^22 - 5825406*u^7*v^21 - 15357030*u^7*v^20 - 
            38016888*u^7*v^19 - 79597110*u^7*v^18 - 129576546*u^7*v^17 - 155403924*u^7*v^16 
            - 127554972*u^7*v^15 - 50020878*u^7*v^14 + 34076880*u^7*v^13 + 77063328*u^7*v^12
            + 66155976*u^7*v^11 + 25833672*u^7*v^10 - 7860348*u^7*v^9 - 16144506*u^7*v^8 - 
            7347960*u^7*v^7 + 569484*u^7*v^6 + 1529418*u^7*v^5 + 395304*u^7*v^4 + 
            27024*u^7*v^3 + 402*u^7*v^2 + 12*u^7*v - 78995*u^6*v^24 - 535380*u^6*v^23 - 
            2182278*u^6*v^22 - 7647932*u^6*v^21 - 24030168*u^6*v^20 - 61872462*u^6*v^19 - 
            121676440*u^6*v^18 - 177536748*u^6*v^17 - 183357558*u^6*v^16 - 
            112470970*u^6*v^15 + 5962032*u^6*v^14 + 104894472*u^6*v^13 + 131690469*u^6*v^12 
            + 86574132*u^6*v^11 + 14242779*u^6*v^10 - 37864542*u^6*v^9 - 49457952*u^6*v^8 - 
            31762692*u^6*v^7 - 10241900*u^6*v^6 - 313008*u^6*v^5 + 706803*u^6*v^4 + 
            137762*u^6*v^3 + 6228*u^6*v^2 + 72*u^6*v + u^6 - 59310*u^5*v^24 - 
            445542*u^5*v^23 - 2302956*u^5*v^22 - 9571290*u^5*v^21 - 30366912*u^5*v^20 - 
            71265930*u^5*v^19 - 121094196*u^5*v^18 - 141525840*u^5*v^17 - 89762412*u^5*v^16 
            + 35684424*u^5*v^15 + 174909744*u^5*v^14 + 247997706*u^5*v^13 + 
            219854814*u^5*v^12 + 119227770*u^5*v^11 + 7792038*u^5*v^10 - 63668736*u^5*v^9 - 
            80370702*u^5*v^8 - 58750974*u^5*v^7 - 27236700*u^5*v^6 - 6700974*u^5*v^5 - 
            175506*u^5*v^4 + 235596*u^5*v^3 + 29004*u^5*v^2 + 702*u^5*v + 6*u^5 - 
            34086*u^4*v^24 - 369564*u^4*v^23 - 2213853*u^4*v^22 - 9009588*u^4*v^21 - 
            25312176*u^4*v^20 - 48992520*u^4*v^19 - 60410802*u^4*v^18 - 25027938*u^4*v^17 + 
            76831287*u^4*v^16 + 216140760*u^4*v^15 + 320848137*u^4*v^14 + 328436190*u^4*v^13
            + 237776532*u^4*v^12 + 103687698*u^4*v^11 - 12469392*u^4*v^10 - 77588766*u^4*v^9
            - 90196938*u^4*v^8 - 68900814*u^4*v^7 - 37462269*u^4*v^6 - 13394316*u^4*v^5 - 
            2407812*u^4*v^4 + 15684*u^4*v^3 + 51033*u^4*v^2 + 2850*u^4*v + 15*u^4 - 
            19458*u^3*v^24 - 253536*u^3*v^23 - 1434792*u^3*v^22 - 4878990*u^3*v^21 - 
            10397874*u^3*v^20 - 11088948*u^3*v^19 + 9303874*u^3*v^18 + 67006470*u^3*v^17 + 
            157302864*u^3*v^16 + 241980548*u^3*v^15 + 269212974*u^3*v^14 + 
            215192880*u^3*v^13 + 106391230*u^3*v^12 - 1674432*u^3*v^11 - 68717712*u^3*v^10 -
            89873154*u^3*v^9 - 80506710*u^3*v^8 - 57365424*u^3*v^7 - 32691202*u^3*v^6 - 
            13945098*u^3*v^5 - 3792948*u^3*v^4 - 427172*u^3*v^3 + 28278*u^3*v^2 + 5400*u^3*v
            + 20*u^3 - 9483*u^2*v^24 - 90564*u^2*v^23 - 374439*u^2*v^22 - 684822*u^2*v^21 + 
            652527*u^2*v^20 + 8172054*u^2*v^19 + 27878289*u^2*v^18 + 60628926*u^2*v^17 + 
            94599669*u^2*v^16 + 106779822*u^2*v^15 + 78485928*u^2*v^14 + 14130648*u^2*v^13 -
            57415086*u^2*v^12 - 103300500*u^2*v^11 - 110085045*u^2*v^10 - 88957518*u^2*v^9 -
            60102729*u^2*v^8 - 35950266*u^2*v^7 - 19185423*u^2*v^6 - 8653998*u^2*v^5 - 
            2896473*u^2*v^4 - 549474*u^2*v^3 - 18150*u^2*v^2 + 5292*u^2*v + 15*u^2 + 
            522*u*v^24 + 7308*u*v^23 + 68646*u*v^22 + 409218*u*v^21 + 1619832*u*v^20 + 
            4517388*u*v^19 + 9110730*u*v^18 + 12833808*u*v^17 + 9965856*u*v^16 - 
            5425956*u*v^15 - 33869076*u*v^14 - 66968454*u*v^13 - 90790944*u*v^12 - 
            95014476*u*v^11 - 79924278*u*v^10 - 55116618*u*v^9 - 31859400*u*v^8 - 
            16064100*u*v^7 - 7407354*u*v^6 - 3154416*u*v^5 - 1147440*u*v^4 - 286164*u*v^3 - 
            26940*u*v^2 + 2622*u*v + 6*u + v^24 + 18*v^23 - 369*v^22 - 6462*v^21 - 
            55653*v^20 - 306324*v^19 - 1185480*v^18 - 3452040*v^17 - 7921299*v^16 - 
            14753538*v^15 - 22734423*v^14 - 29340342*v^13 - 31922930*v^12 - 29339838*v^11 - 
            22742487*v^10 - 14802930*v^9 - 8057379*v^8 - 3693456*v^7 - 1477800*v^6 - 
            547740*v^5 - 191733*v^4 - 55854*v^3 - 8433*v^2 + 522*v + 1)^(2)/((v)^(12)*(v + 
            1)^(6)*(u^2*v + u*v^2 + u*v + u + v)^(15));

    end if;

    return jj, jj_1728;
end function;
